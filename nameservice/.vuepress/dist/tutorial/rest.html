<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Nameservice Module Rest Interface</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/assets/css/0.styles.0fa35ecc.css" as="style"><link rel="preload" href="/assets/js/app.358745d0.js" as="script"><link rel="preload" href="/assets/js/41.003066df.js" as="script"><link rel="prefetch" href="/assets/js/10.ed56b2dd.js"><link rel="prefetch" href="/assets/js/11.b9448339.js"><link rel="prefetch" href="/assets/js/12.d9540af2.js"><link rel="prefetch" href="/assets/js/13.8738af6e.js"><link rel="prefetch" href="/assets/js/14.7ef7ba9a.js"><link rel="prefetch" href="/assets/js/15.01af3069.js"><link rel="prefetch" href="/assets/js/16.5f272536.js"><link rel="prefetch" href="/assets/js/17.950b1488.js"><link rel="prefetch" href="/assets/js/18.97cd0ce2.js"><link rel="prefetch" href="/assets/js/19.c15b4c92.js"><link rel="prefetch" href="/assets/js/2.7459dab1.js"><link rel="prefetch" href="/assets/js/20.46ad9e71.js"><link rel="prefetch" href="/assets/js/21.1aaf8749.js"><link rel="prefetch" href="/assets/js/22.ed2cbdbe.js"><link rel="prefetch" href="/assets/js/23.d29efe89.js"><link rel="prefetch" href="/assets/js/24.6efbd344.js"><link rel="prefetch" href="/assets/js/25.99eafa78.js"><link rel="prefetch" href="/assets/js/26.59c51545.js"><link rel="prefetch" href="/assets/js/27.09db857f.js"><link rel="prefetch" href="/assets/js/28.de9e6f97.js"><link rel="prefetch" href="/assets/js/29.a95ec837.js"><link rel="prefetch" href="/assets/js/3.3b8bb6a2.js"><link rel="prefetch" href="/assets/js/30.ec4f2e27.js"><link rel="prefetch" href="/assets/js/31.39335b08.js"><link rel="prefetch" href="/assets/js/32.5e4a40ba.js"><link rel="prefetch" href="/assets/js/33.2d12c22c.js"><link rel="prefetch" href="/assets/js/34.6a06e4fa.js"><link rel="prefetch" href="/assets/js/35.37ad73ec.js"><link rel="prefetch" href="/assets/js/36.c90ef3a4.js"><link rel="prefetch" href="/assets/js/37.fcf1b3b5.js"><link rel="prefetch" href="/assets/js/38.549dbd91.js"><link rel="prefetch" href="/assets/js/39.c25f4a9a.js"><link rel="prefetch" href="/assets/js/4.ff53f1d1.js"><link rel="prefetch" href="/assets/js/40.29b6dbc5.js"><link rel="prefetch" href="/assets/js/42.59cc5a5a.js"><link rel="prefetch" href="/assets/js/43.5877f03f.js"><link rel="prefetch" href="/assets/js/44.97ed4d02.js"><link rel="prefetch" href="/assets/js/45.2be01aab.js"><link rel="prefetch" href="/assets/js/5.d936167e.js"><link rel="prefetch" href="/assets/js/6.f824f7e2.js"><link rel="prefetch" href="/assets/js/7.e6534aea.js"><link rel="prefetch" href="/assets/js/8.1b43487c.js"><link rel="prefetch" href="/assets/js/9.a7040e01.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0fa35ecc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><!---->  <!----> </div> <div class="page"> <div class="content"><h1 id="nameservice-module-rest-interface"><a href="#nameservice-module-rest-interface" aria-hidden="true" class="header-anchor">#</a> Nameservice Module Rest Interface</h1> <p>Your module can also expose a REST interface to allow programatic access to the module's functionality. To get started create a file to hold the HTTP handlers:</p> <ul><li><code>./x/nameservice/client/rest/rest.go</code></li></ul> <p>Add in the <code>imports</code> and <code>const</code>s to get started:</p> <blockquote><p><em><em>NOTE</em></em>: Your application needs to import the code you just wrote. Here the import path is set to this repository (<code>github.com/cosmos/sdk-application-tutorial/x/nameservice</code>). If you are following along in your own repo you will need to change the import path to reflect that (<code>github.com/{ .Username }/{ .Project.Repo }/x/nameservice</code>).</p></blockquote> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> rest

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;net/http&quot;</span>

	<span class="token string">&quot;github.com/cosmos/cosmos-sdk/client/context&quot;</span>
	<span class="token string">&quot;github.com/cosmos/sdk-application-tutorial/x/nameservice/types&quot;</span>

	<span class="token string">&quot;github.com/cosmos/cosmos-sdk/codec&quot;</span>
	sdk <span class="token string">&quot;github.com/cosmos/cosmos-sdk/types&quot;</span>
	<span class="token string">&quot;github.com/cosmos/cosmos-sdk/types/rest&quot;</span>

	<span class="token string">&quot;github.com/gorilla/mux&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token punctuation">(</span>
	restName <span class="token operator">=</span> <span class="token string">&quot;name&quot;</span>
<span class="token punctuation">)</span>
</code></pre></div><h3 id="registerroutes"><a href="#registerroutes" aria-hidden="true" class="header-anchor">#</a> RegisterRoutes</h3> <p>First, define the REST client interface for your module in a <code>RegisterRoutes</code> function. Have the routes all start with your module name to prevent name space collisions with other modules' routes:</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// RegisterRoutes - Central function to define routes that get registered by the main application</span>
<span class="token keyword">func</span> <span class="token function">RegisterRoutes</span><span class="token punctuation">(</span>cliCtx context<span class="token punctuation">.</span>CLIContext<span class="token punctuation">,</span> r <span class="token operator">*</span>mux<span class="token punctuation">.</span>Router<span class="token punctuation">,</span> cdc <span class="token operator">*</span>codec<span class="token punctuation">.</span>Codec<span class="token punctuation">,</span> storeName <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	r<span class="token punctuation">.</span><span class="token function">HandleFunc</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;/%s/names&quot;</span><span class="token punctuation">,</span> storeName<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">namesHandler</span><span class="token punctuation">(</span>cdc<span class="token punctuation">,</span> cliCtx<span class="token punctuation">,</span> storeName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Methods</span><span class="token punctuation">(</span><span class="token string">&quot;GET&quot;</span><span class="token punctuation">)</span>
	r<span class="token punctuation">.</span><span class="token function">HandleFunc</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;/%s/names&quot;</span><span class="token punctuation">,</span> storeName<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">buyNameHandler</span><span class="token punctuation">(</span>cdc<span class="token punctuation">,</span> cliCtx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Methods</span><span class="token punctuation">(</span><span class="token string">&quot;POST&quot;</span><span class="token punctuation">)</span>
	r<span class="token punctuation">.</span><span class="token function">HandleFunc</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;/%s/names&quot;</span><span class="token punctuation">,</span> storeName<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">setNameHandler</span><span class="token punctuation">(</span>cdc<span class="token punctuation">,</span> cliCtx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Methods</span><span class="token punctuation">(</span><span class="token string">&quot;PUT&quot;</span><span class="token punctuation">)</span>
	r<span class="token punctuation">.</span><span class="token function">HandleFunc</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;/%s/names/{%s}&quot;</span><span class="token punctuation">,</span> storeName<span class="token punctuation">,</span> restName<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">resolveNameHandler</span><span class="token punctuation">(</span>cdc<span class="token punctuation">,</span> cliCtx<span class="token punctuation">,</span> storeName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Methods</span><span class="token punctuation">(</span><span class="token string">&quot;GET&quot;</span><span class="token punctuation">)</span>
	r<span class="token punctuation">.</span><span class="token function">HandleFunc</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;/%s/names/{%s}/whois&quot;</span><span class="token punctuation">,</span> storeName<span class="token punctuation">,</span> restName<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">whoIsHandler</span><span class="token punctuation">(</span>cdc<span class="token punctuation">,</span> cliCtx<span class="token punctuation">,</span> storeName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Methods</span><span class="token punctuation">(</span><span class="token string">&quot;GET&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="query-handlers"><a href="#query-handlers" aria-hidden="true" class="header-anchor">#</a> Query Handlers</h3> <p>Next, its time to define the handlers mentioned above. These will be very similar to the CLI methods defined earlier. Start with the queries <code>whois</code> and <code>resolve</code>:</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">resolveNameHandler</span><span class="token punctuation">(</span>cliCtx context<span class="token punctuation">.</span>CLIContext<span class="token punctuation">,</span> storeName <span class="token builtin">string</span><span class="token punctuation">)</span> http<span class="token punctuation">.</span>HandlerFunc <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">func</span><span class="token punctuation">(</span>w http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> r <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		vars <span class="token operator">:=</span> mux<span class="token punctuation">.</span><span class="token function">Vars</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span>
		paramType <span class="token operator">:=</span> vars<span class="token punctuation">[</span>restName<span class="token punctuation">]</span>

		res<span class="token punctuation">,</span> <span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> cliCtx<span class="token punctuation">.</span><span class="token function">QueryWithData</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;custom/%s/resolve/%s&quot;</span><span class="token punctuation">,</span> storeName<span class="token punctuation">,</span> paramType<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
			rest<span class="token punctuation">.</span><span class="token function">WriteErrorResponse</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> http<span class="token punctuation">.</span>StatusNotFound<span class="token punctuation">,</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token keyword">return</span>
		<span class="token punctuation">}</span>

		rest<span class="token punctuation">.</span><span class="token function">PostProcessResponse</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> cliCtx<span class="token punctuation">,</span> res<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">whoIsHandler</span><span class="token punctuation">(</span>cliCtx context<span class="token punctuation">.</span>CLIContext<span class="token punctuation">,</span> storeName <span class="token builtin">string</span><span class="token punctuation">)</span> http<span class="token punctuation">.</span>HandlerFunc <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">func</span><span class="token punctuation">(</span>w http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> r <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		vars <span class="token operator">:=</span> mux<span class="token punctuation">.</span><span class="token function">Vars</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span>
		paramType <span class="token operator">:=</span> vars<span class="token punctuation">[</span>restName<span class="token punctuation">]</span>

		res<span class="token punctuation">,</span> <span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> cliCtx<span class="token punctuation">.</span><span class="token function">QueryWithData</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;custom/%s/whois/%s&quot;</span><span class="token punctuation">,</span> storeName<span class="token punctuation">,</span> paramType<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
			rest<span class="token punctuation">.</span><span class="token function">WriteErrorResponse</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> http<span class="token punctuation">.</span>StatusNotFound<span class="token punctuation">,</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token keyword">return</span>
		<span class="token punctuation">}</span>

		rest<span class="token punctuation">.</span><span class="token function">PostProcessResponse</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> cliCtx<span class="token punctuation">,</span> res<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">namesHandler</span><span class="token punctuation">(</span>cliCtx context<span class="token punctuation">.</span>CLIContext<span class="token punctuation">,</span> storeName <span class="token builtin">string</span><span class="token punctuation">)</span> http<span class="token punctuation">.</span>HandlerFunc <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">func</span><span class="token punctuation">(</span>w http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> r <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		res<span class="token punctuation">,</span> <span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> cliCtx<span class="token punctuation">.</span><span class="token function">QueryWithData</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;custom/%s/names&quot;</span><span class="token punctuation">,</span> storeName<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
			rest<span class="token punctuation">.</span><span class="token function">WriteErrorResponse</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> http<span class="token punctuation">.</span>StatusNotFound<span class="token punctuation">,</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token keyword">return</span>
		<span class="token punctuation">}</span>
		rest<span class="token punctuation">.</span><span class="token function">PostProcessResponse</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> cliCtx<span class="token punctuation">,</span> res<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Notes on the above code:</p> <ul><li>Notice we are using the same <code>cliCtx.QueryWithData</code> function to fetch the data</li> <li>These functions are almost the same as the corresponding CLI functionality</li></ul> <h3 id="tx-handlers"><a href="#tx-handlers" aria-hidden="true" class="header-anchor">#</a> Tx Handlers</h3> <p>Now define the <code>buyName</code> and <code>setName</code> transaction routes. Notice these aren't actually sending the transactions to buy and set names. That would require sending a password along with the request which would be a security issue. Instead these endpoints build and return each specific transaction which can then be signed in a secure manner and afterwards broadcast to the network using a standard endpoint like <code>/txs</code>.</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> buyNameReq <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	BaseReq rest<span class="token punctuation">.</span>BaseReq <span class="token string">`json:&quot;base_req&quot;`</span>
	Name    <span class="token builtin">string</span>       <span class="token string">`json:&quot;name&quot;`</span>
	Amount  <span class="token builtin">string</span>       <span class="token string">`json:&quot;amount&quot;`</span>
	Buyer   <span class="token builtin">string</span>       <span class="token string">`json:&quot;buyer&quot;`</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">buyNameHandler</span><span class="token punctuation">(</span>cliCtx context<span class="token punctuation">.</span>CLIContext<span class="token punctuation">)</span> http<span class="token punctuation">.</span>HandlerFunc <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">func</span><span class="token punctuation">(</span>w http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> r <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">var</span> req buyNameReq

		<span class="token keyword">if</span> <span class="token operator">!</span>rest<span class="token punctuation">.</span><span class="token function">ReadRESTReq</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> r<span class="token punctuation">,</span> cliCtx<span class="token punctuation">.</span>Codec<span class="token punctuation">,</span> <span class="token operator">&amp;</span>req<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			rest<span class="token punctuation">.</span><span class="token function">WriteErrorResponse</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> http<span class="token punctuation">.</span>StatusBadRequest<span class="token punctuation">,</span> <span class="token string">&quot;failed to parse request&quot;</span><span class="token punctuation">)</span>
			<span class="token keyword">return</span>
		<span class="token punctuation">}</span>

		baseReq <span class="token operator">:=</span> req<span class="token punctuation">.</span>BaseReq<span class="token punctuation">.</span><span class="token function">Sanitize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> <span class="token operator">!</span>baseReq<span class="token punctuation">.</span><span class="token function">ValidateBasic</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span>
		<span class="token punctuation">}</span>

		addr<span class="token punctuation">,</span> err <span class="token operator">:=</span> sdk<span class="token punctuation">.</span><span class="token function">AccAddressFromBech32</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>Buyer<span class="token punctuation">)</span>
		<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
			rest<span class="token punctuation">.</span><span class="token function">WriteErrorResponse</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> http<span class="token punctuation">.</span>StatusBadRequest<span class="token punctuation">,</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token keyword">return</span>
		<span class="token punctuation">}</span>

		coins<span class="token punctuation">,</span> err <span class="token operator">:=</span> sdk<span class="token punctuation">.</span><span class="token function">ParseCoins</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>Amount<span class="token punctuation">)</span>
		<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
			rest<span class="token punctuation">.</span><span class="token function">WriteErrorResponse</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> http<span class="token punctuation">.</span>StatusBadRequest<span class="token punctuation">,</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token keyword">return</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// create the message</span>
		msg <span class="token operator">:=</span> types<span class="token punctuation">.</span><span class="token function">NewMsgBuyName</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> coins<span class="token punctuation">,</span> addr<span class="token punctuation">)</span>
		err <span class="token operator">=</span> msg<span class="token punctuation">.</span><span class="token function">ValidateBasic</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
			rest<span class="token punctuation">.</span><span class="token function">WriteErrorResponse</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> http<span class="token punctuation">.</span>StatusBadRequest<span class="token punctuation">,</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token keyword">return</span>
		<span class="token punctuation">}</span>

		utils<span class="token punctuation">.</span><span class="token function">WriteGenerateStdTxResponse</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> cliCtx<span class="token punctuation">,</span> baseReq<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>sdk<span class="token punctuation">.</span>Msg<span class="token punctuation">{</span>msg<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> setNameReq <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	BaseReq rest<span class="token punctuation">.</span>BaseReq <span class="token string">`json:&quot;base_req&quot;`</span>
	Name    <span class="token builtin">string</span>       <span class="token string">`json:&quot;name&quot;`</span>
	Value   <span class="token builtin">string</span>       <span class="token string">`json:&quot;value&quot;`</span>
	Owner   <span class="token builtin">string</span>       <span class="token string">`json:&quot;owner&quot;`</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">setNameHandler</span><span class="token punctuation">(</span>cliCtx context<span class="token punctuation">.</span>CLIContext<span class="token punctuation">)</span> http<span class="token punctuation">.</span>HandlerFunc <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">func</span><span class="token punctuation">(</span>w http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> r <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">var</span> req setNameReq
		<span class="token keyword">if</span> <span class="token operator">!</span>rest<span class="token punctuation">.</span><span class="token function">ReadRESTReq</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> r<span class="token punctuation">,</span> cliCtx<span class="token punctuation">.</span>Codec<span class="token punctuation">,</span> <span class="token operator">&amp;</span>req<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			rest<span class="token punctuation">.</span><span class="token function">WriteErrorResponse</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> http<span class="token punctuation">.</span>StatusBadRequest<span class="token punctuation">,</span> <span class="token string">&quot;failed to parse request&quot;</span><span class="token punctuation">)</span>
			<span class="token keyword">return</span>
		<span class="token punctuation">}</span>

		baseReq <span class="token operator">:=</span> req<span class="token punctuation">.</span>BaseReq<span class="token punctuation">.</span><span class="token function">Sanitize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> <span class="token operator">!</span>baseReq<span class="token punctuation">.</span><span class="token function">ValidateBasic</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span>
		<span class="token punctuation">}</span>

		addr<span class="token punctuation">,</span> err <span class="token operator">:=</span> sdk<span class="token punctuation">.</span><span class="token function">AccAddressFromBech32</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>Owner<span class="token punctuation">)</span>
		<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
			rest<span class="token punctuation">.</span><span class="token function">WriteErrorResponse</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> http<span class="token punctuation">.</span>StatusBadRequest<span class="token punctuation">,</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token keyword">return</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// create the message</span>
		msg <span class="token operator">:=</span> types<span class="token punctuation">.</span><span class="token function">NewMsgSetName</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> req<span class="token punctuation">.</span>Value<span class="token punctuation">,</span> addr<span class="token punctuation">)</span>
		err <span class="token operator">=</span> msg<span class="token punctuation">.</span><span class="token function">ValidateBasic</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
			rest<span class="token punctuation">.</span><span class="token function">WriteErrorResponse</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> http<span class="token punctuation">.</span>StatusBadRequest<span class="token punctuation">,</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token keyword">return</span>
		<span class="token punctuation">}</span>

		utils<span class="token punctuation">.</span><span class="token function">WriteGenerateStdTxResponse</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> cliCtx<span class="token punctuation">,</span> baseReq<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>sdk<span class="token punctuation">.</span>Msg<span class="token punctuation">{</span>msg<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Notes on the above code:</p> <ul><li>The <a href="https://godoc.org/github.com/cosmos/cosmos-sdk/client/utils#BaseReq" target="_blank" rel="noopener noreferrer"><code>BaseReq</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> contains the basic required fields for making a transaction (which key to use, how to decode it, which chain you are on, etc...) and is designed to be embedded as shown.</li> <li><code>baseReq.ValidateBasic</code> handles setting the response code for you and therefore you don't need to worry about handling errors or successes when using those functions.</li></ul> <h3 id="next-its-time-to-augment-nameservice-by-implementing-the-appmodule-interface"><a href="#next-its-time-to-augment-nameservice-by-implementing-the-appmodule-interface" aria-hidden="true" class="header-anchor">#</a> Next its time to augment <code>nameservice</code> by implementing the <a href="/tutorial/module.html">AppModule interface</a>!</h3></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.358745d0.js" defer></script><script src="/assets/js/41.003066df.js" defer></script>
  </body>
</html>
