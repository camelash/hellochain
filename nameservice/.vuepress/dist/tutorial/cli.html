<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Nameservice Module CLI</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/assets/css/0.styles.0fa35ecc.css" as="style"><link rel="preload" href="/assets/js/app.358745d0.js" as="script"><link rel="preload" href="/assets/js/13.8738af6e.js" as="script"><link rel="prefetch" href="/assets/js/10.ed56b2dd.js"><link rel="prefetch" href="/assets/js/11.b9448339.js"><link rel="prefetch" href="/assets/js/12.d9540af2.js"><link rel="prefetch" href="/assets/js/14.7ef7ba9a.js"><link rel="prefetch" href="/assets/js/15.01af3069.js"><link rel="prefetch" href="/assets/js/16.5f272536.js"><link rel="prefetch" href="/assets/js/17.950b1488.js"><link rel="prefetch" href="/assets/js/18.97cd0ce2.js"><link rel="prefetch" href="/assets/js/19.c15b4c92.js"><link rel="prefetch" href="/assets/js/2.7459dab1.js"><link rel="prefetch" href="/assets/js/20.46ad9e71.js"><link rel="prefetch" href="/assets/js/21.1aaf8749.js"><link rel="prefetch" href="/assets/js/22.ed2cbdbe.js"><link rel="prefetch" href="/assets/js/23.d29efe89.js"><link rel="prefetch" href="/assets/js/24.6efbd344.js"><link rel="prefetch" href="/assets/js/25.99eafa78.js"><link rel="prefetch" href="/assets/js/26.59c51545.js"><link rel="prefetch" href="/assets/js/27.09db857f.js"><link rel="prefetch" href="/assets/js/28.de9e6f97.js"><link rel="prefetch" href="/assets/js/29.a95ec837.js"><link rel="prefetch" href="/assets/js/3.3b8bb6a2.js"><link rel="prefetch" href="/assets/js/30.ec4f2e27.js"><link rel="prefetch" href="/assets/js/31.39335b08.js"><link rel="prefetch" href="/assets/js/32.5e4a40ba.js"><link rel="prefetch" href="/assets/js/33.2d12c22c.js"><link rel="prefetch" href="/assets/js/34.6a06e4fa.js"><link rel="prefetch" href="/assets/js/35.37ad73ec.js"><link rel="prefetch" href="/assets/js/36.c90ef3a4.js"><link rel="prefetch" href="/assets/js/37.fcf1b3b5.js"><link rel="prefetch" href="/assets/js/38.549dbd91.js"><link rel="prefetch" href="/assets/js/39.c25f4a9a.js"><link rel="prefetch" href="/assets/js/4.ff53f1d1.js"><link rel="prefetch" href="/assets/js/40.29b6dbc5.js"><link rel="prefetch" href="/assets/js/41.003066df.js"><link rel="prefetch" href="/assets/js/42.59cc5a5a.js"><link rel="prefetch" href="/assets/js/43.5877f03f.js"><link rel="prefetch" href="/assets/js/44.97ed4d02.js"><link rel="prefetch" href="/assets/js/45.2be01aab.js"><link rel="prefetch" href="/assets/js/5.d936167e.js"><link rel="prefetch" href="/assets/js/6.f824f7e2.js"><link rel="prefetch" href="/assets/js/7.e6534aea.js"><link rel="prefetch" href="/assets/js/8.1b43487c.js"><link rel="prefetch" href="/assets/js/9.a7040e01.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0fa35ecc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><!---->  <!----> </div> <div class="page"> <div class="content"><h1 id="nameservice-module-cli"><a href="#nameservice-module-cli" aria-hidden="true" class="header-anchor">#</a> Nameservice Module CLI</h1> <p>The Cosmos SDK uses the <a href="https://github.com/spf13/cobra" target="_blank" rel="noopener noreferrer"><code>cobra</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> library for CLI interactions. This library makes it easy for each module to expose its own commands. To get started defining the user's CLI interactions with your module, create the following files:</p> <ul><li><code>./x/nameservice/client/cli/query.go</code></li> <li><code>./x/nameservice/client/cli/tx.go</code></li></ul> <h2 id="queries"><a href="#queries" aria-hidden="true" class="header-anchor">#</a> Queries</h2> <p>Start in <code>query.go</code>. Here, define <code>cobra.Command</code>s for each of your modules <code>Queriers</code> (<code>resolve</code>, and <code>whois</code>):</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> cli

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>

	<span class="token string">&quot;github.com/cosmos/cosmos-sdk/client&quot;</span>
	<span class="token string">&quot;github.com/cosmos/cosmos-sdk/client/context&quot;</span>
	<span class="token string">&quot;github.com/cosmos/cosmos-sdk/codec&quot;</span>
	<span class="token string">&quot;github.com/cosmos/sdk-application-tutorial/x/nameservice/types&quot;</span>
	<span class="token string">&quot;github.com/spf13/cobra&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">GetQueryCmd</span><span class="token punctuation">(</span>storeKey <span class="token builtin">string</span><span class="token punctuation">,</span> cdc <span class="token operator">*</span>codec<span class="token punctuation">.</span>Codec<span class="token punctuation">)</span> <span class="token operator">*</span>cobra<span class="token punctuation">.</span>Command <span class="token punctuation">{</span>
	nameserviceQueryCmd <span class="token operator">:=</span> <span class="token operator">&amp;</span>cobra<span class="token punctuation">.</span>Command<span class="token punctuation">{</span>
		Use<span class="token punctuation">:</span>                        types<span class="token punctuation">.</span>ModuleName<span class="token punctuation">,</span>
		Short<span class="token punctuation">:</span>                      <span class="token string">&quot;Querying commands for the nameservice module&quot;</span><span class="token punctuation">,</span>
		DisableFlagParsing<span class="token punctuation">:</span>         <span class="token boolean">true</span><span class="token punctuation">,</span>
		SuggestionsMinimumDistance<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
		RunE<span class="token punctuation">:</span>                       client<span class="token punctuation">.</span>ValidateCmd<span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	nameserviceQueryCmd<span class="token punctuation">.</span><span class="token function">AddCommand</span><span class="token punctuation">(</span>client<span class="token punctuation">.</span><span class="token function">GetCommands</span><span class="token punctuation">(</span>
		<span class="token function">GetCmdResolveName</span><span class="token punctuation">(</span>storeKey<span class="token punctuation">,</span> cdc<span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token function">GetCmdWhois</span><span class="token punctuation">(</span>storeKey<span class="token punctuation">,</span> cdc<span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token function">GetCmdNames</span><span class="token punctuation">(</span>storeKey<span class="token punctuation">,</span> cdc<span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">)</span><span class="token operator">...</span><span class="token punctuation">)</span>
	<span class="token keyword">return</span> nameserviceQueryCmd
<span class="token punctuation">}</span>

<span class="token comment">// GetCmdResolveName queries information about a name</span>
<span class="token keyword">func</span> <span class="token function">GetCmdResolveName</span><span class="token punctuation">(</span>queryRoute <span class="token builtin">string</span><span class="token punctuation">,</span> cdc <span class="token operator">*</span>codec<span class="token punctuation">.</span>Codec<span class="token punctuation">)</span> <span class="token operator">*</span>cobra<span class="token punctuation">.</span>Command <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>cobra<span class="token punctuation">.</span>Command<span class="token punctuation">{</span>
		Use<span class="token punctuation">:</span>   <span class="token string">&quot;resolve [name]&quot;</span><span class="token punctuation">,</span>
		Short<span class="token punctuation">:</span> <span class="token string">&quot;resolve name&quot;</span><span class="token punctuation">,</span>
		Args<span class="token punctuation">:</span>  cobra<span class="token punctuation">.</span><span class="token function">ExactArgs</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		RunE<span class="token punctuation">:</span> <span class="token keyword">func</span><span class="token punctuation">(</span>cmd <span class="token operator">*</span>cobra<span class="token punctuation">.</span>Command<span class="token punctuation">,</span> args <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
			cliCtx <span class="token operator">:=</span> context<span class="token punctuation">.</span><span class="token function">NewCLIContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">WithCodec</span><span class="token punctuation">(</span>cdc<span class="token punctuation">)</span>
			name <span class="token operator">:=</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

			res<span class="token punctuation">,</span> <span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> cliCtx<span class="token punctuation">.</span><span class="token function">QueryWithData</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;custom/%s/resolve/%s&quot;</span><span class="token punctuation">,</span> queryRoute<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
			<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
				fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;could not resolve name - %s \n&quot;</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span>
				<span class="token keyword">return</span> <span class="token boolean">nil</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">var</span> out types<span class="token punctuation">.</span>QueryResResolve
			cdc<span class="token punctuation">.</span><span class="token function">MustUnmarshalJSON</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token operator">&amp;</span>out<span class="token punctuation">)</span>
			<span class="token keyword">return</span> cliCtx<span class="token punctuation">.</span><span class="token function">PrintOutput</span><span class="token punctuation">(</span>out<span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// GetCmdWhois queries information about a domain</span>
<span class="token keyword">func</span> <span class="token function">GetCmdWhois</span><span class="token punctuation">(</span>queryRoute <span class="token builtin">string</span><span class="token punctuation">,</span> cdc <span class="token operator">*</span>codec<span class="token punctuation">.</span>Codec<span class="token punctuation">)</span> <span class="token operator">*</span>cobra<span class="token punctuation">.</span>Command <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>cobra<span class="token punctuation">.</span>Command<span class="token punctuation">{</span>
		Use<span class="token punctuation">:</span>   <span class="token string">&quot;whois [name]&quot;</span><span class="token punctuation">,</span>
		Short<span class="token punctuation">:</span> <span class="token string">&quot;Query whois info of name&quot;</span><span class="token punctuation">,</span>
		Args<span class="token punctuation">:</span>  cobra<span class="token punctuation">.</span><span class="token function">ExactArgs</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		RunE<span class="token punctuation">:</span> <span class="token keyword">func</span><span class="token punctuation">(</span>cmd <span class="token operator">*</span>cobra<span class="token punctuation">.</span>Command<span class="token punctuation">,</span> args <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
			cliCtx <span class="token operator">:=</span> context<span class="token punctuation">.</span><span class="token function">NewCLIContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">WithCodec</span><span class="token punctuation">(</span>cdc<span class="token punctuation">)</span>
			name <span class="token operator">:=</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

			res<span class="token punctuation">,</span> <span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> cliCtx<span class="token punctuation">.</span><span class="token function">QueryWithData</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;custom/%s/whois/%s&quot;</span><span class="token punctuation">,</span> queryRoute<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
			<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
				fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;could not resolve whois - %s \n&quot;</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span>
				<span class="token keyword">return</span> <span class="token boolean">nil</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">var</span> out types<span class="token punctuation">.</span>Whois
			cdc<span class="token punctuation">.</span><span class="token function">MustUnmarshalJSON</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token operator">&amp;</span>out<span class="token punctuation">)</span>
			<span class="token keyword">return</span> cliCtx<span class="token punctuation">.</span><span class="token function">PrintOutput</span><span class="token punctuation">(</span>out<span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// GetCmdNames queries a list of all names</span>
<span class="token keyword">func</span> <span class="token function">GetCmdNames</span><span class="token punctuation">(</span>queryRoute <span class="token builtin">string</span><span class="token punctuation">,</span> cdc <span class="token operator">*</span>codec<span class="token punctuation">.</span>Codec<span class="token punctuation">)</span> <span class="token operator">*</span>cobra<span class="token punctuation">.</span>Command <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>cobra<span class="token punctuation">.</span>Command<span class="token punctuation">{</span>
		Use<span class="token punctuation">:</span>   <span class="token string">&quot;names&quot;</span><span class="token punctuation">,</span>
		Short<span class="token punctuation">:</span> <span class="token string">&quot;names&quot;</span><span class="token punctuation">,</span>
		<span class="token comment">// Args:  cobra.ExactArgs(1),</span>
		RunE<span class="token punctuation">:</span> <span class="token keyword">func</span><span class="token punctuation">(</span>cmd <span class="token operator">*</span>cobra<span class="token punctuation">.</span>Command<span class="token punctuation">,</span> args <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
			cliCtx <span class="token operator">:=</span> context<span class="token punctuation">.</span><span class="token function">NewCLIContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">WithCodec</span><span class="token punctuation">(</span>cdc<span class="token punctuation">)</span>

			res<span class="token punctuation">,</span> <span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> cliCtx<span class="token punctuation">.</span><span class="token function">QueryWithData</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;custom/%s/names&quot;</span><span class="token punctuation">,</span> queryRoute<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
			<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
				fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;could not get query names\n&quot;</span><span class="token punctuation">)</span>
				<span class="token keyword">return</span> <span class="token boolean">nil</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">var</span> out types<span class="token punctuation">.</span>QueryResNames
			cdc<span class="token punctuation">.</span><span class="token function">MustUnmarshalJSON</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token operator">&amp;</span>out<span class="token punctuation">)</span>
			<span class="token keyword">return</span> cliCtx<span class="token punctuation">.</span><span class="token function">PrintOutput</span><span class="token punctuation">(</span>out<span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Notes on the above code:</p> <ul><li>The CLI introduces a new <code>context</code>: <a href="https://godoc.org/github.com/cosmos/cosmos-sdk/client/context#CLIContext" target="_blank" rel="noopener noreferrer"><code>CLIContext</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. It carries data about user input and application configuration that are needed for CLI interactions.</li> <li>The <code>path</code> required for the <code>cliCtx.QueryWithData()</code> function maps directly to the names in your query router.
<ul><li>The first part of the path is used to differentiate the types of queries possible to SDK applications: <code>custom</code> is for <code>Queriers</code>.</li> <li>The second piece (<code>nameservice</code>) is the name of the module to route the query to.</li> <li>Finally there is the specific querier in the module that will be called.</li> <li>In this example the fourth piece is the query. This works because the query parameter is a simple string. To enable more complex query inputs you need to use the second argument of the <a href="https://godoc.org/github.com/cosmos/cosmos-sdk/client/context#CLIContext.QueryWithData" target="_blank" rel="noopener noreferrer"><code>.QueryWithData()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> function to pass in <code>data</code>. For an example of this see the <a href="https://github.com/cosmos/cosmos-sdk/blob/develop/x/stake/querier/querier.go#L103" target="_blank" rel="noopener noreferrer">queriers in the Staking module<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</li></ul></li></ul> <h2 id="transactions"><a href="#transactions" aria-hidden="true" class="header-anchor">#</a> Transactions</h2> <p>Now that the query interactions are defined, it is time to move on to transaction generation in <code>tx.go</code>:</p> <blockquote><p><em><em>NOTE</em></em>: Your application needs to import the code you just wrote. Here the import path is set to this repository (<code>github.com/cosmos/sdk-application-tutorial/x/nameservice</code>). If you are following along in your own repo you will need to change the import path to reflect that (<code>github.com/{ .Username }/{ .Project.Repo }/x/nameservice</code>).</p></blockquote> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> cli

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;github.com/spf13/cobra&quot;</span>

	<span class="token string">&quot;github.com/cosmos/cosmos-sdk/client&quot;</span>
	<span class="token string">&quot;github.com/cosmos/cosmos-sdk/client/context&quot;</span>
	<span class="token string">&quot;github.com/cosmos/cosmos-sdk/codec&quot;</span>
	<span class="token string">&quot;github.com/cosmos/sdk-application-tutorial/x/nameservice/types&quot;</span>
	<span class="token string">&quot;github.com/cosmos/cosmos-sdk/x/auth/client/utils&quot;</span>
	sdk <span class="token string">&quot;github.com/cosmos/cosmos-sdk/types&quot;</span>
	<span class="token string">&quot;github.com/cosmos/cosmos-sdk/x/auth&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">GetTxCmd</span><span class="token punctuation">(</span>storeKey <span class="token builtin">string</span><span class="token punctuation">,</span> cdc <span class="token operator">*</span>codec<span class="token punctuation">.</span>Codec<span class="token punctuation">)</span> <span class="token operator">*</span>cobra<span class="token punctuation">.</span>Command <span class="token punctuation">{</span>
	nameserviceTxCmd <span class="token operator">:=</span> <span class="token operator">&amp;</span>cobra<span class="token punctuation">.</span>Command<span class="token punctuation">{</span>
		Use<span class="token punctuation">:</span>                        types<span class="token punctuation">.</span>ModuleName<span class="token punctuation">,</span>
		Short<span class="token punctuation">:</span>                      <span class="token string">&quot;Nameservice transaction subcommands&quot;</span><span class="token punctuation">,</span>
		DisableFlagParsing<span class="token punctuation">:</span>         <span class="token boolean">true</span><span class="token punctuation">,</span>
		SuggestionsMinimumDistance<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
		RunE<span class="token punctuation">:</span>                       client<span class="token punctuation">.</span>ValidateCmd<span class="token punctuation">,</span>
	<span class="token punctuation">}</span>

	nameserviceTxCmd<span class="token punctuation">.</span><span class="token function">AddCommand</span><span class="token punctuation">(</span>client<span class="token punctuation">.</span><span class="token function">PostCommands</span><span class="token punctuation">(</span>
		<span class="token function">GetCmdBuyName</span><span class="token punctuation">(</span>cdc<span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token function">GetCmdSetName</span><span class="token punctuation">(</span>cdc<span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">)</span><span class="token operator">...</span><span class="token punctuation">)</span>

	<span class="token keyword">return</span> nameserviceTxCmd
<span class="token punctuation">}</span>

<span class="token comment">// GetCmdBuyName is the CLI command for sending a BuyName transaction</span>
<span class="token keyword">func</span> <span class="token function">GetCmdBuyName</span><span class="token punctuation">(</span>cdc <span class="token operator">*</span>codec<span class="token punctuation">.</span>Codec<span class="token punctuation">)</span> <span class="token operator">*</span>cobra<span class="token punctuation">.</span>Command <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>cobra<span class="token punctuation">.</span>Command<span class="token punctuation">{</span>
		Use<span class="token punctuation">:</span>   <span class="token string">&quot;buy-name [name] [amount]&quot;</span><span class="token punctuation">,</span>
		Short<span class="token punctuation">:</span> <span class="token string">&quot;bid for existing name or claim new name&quot;</span><span class="token punctuation">,</span>
		Args<span class="token punctuation">:</span>  cobra<span class="token punctuation">.</span><span class="token function">ExactArgs</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		RunE<span class="token punctuation">:</span> <span class="token keyword">func</span><span class="token punctuation">(</span>cmd <span class="token operator">*</span>cobra<span class="token punctuation">.</span>Command<span class="token punctuation">,</span> args <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
			cliCtx <span class="token operator">:=</span> context<span class="token punctuation">.</span><span class="token function">NewCLIContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">WithCodec</span><span class="token punctuation">(</span>cdc<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">WithAccountDecoder</span><span class="token punctuation">(</span>cdc<span class="token punctuation">)</span>

			txBldr <span class="token operator">:=</span> auth<span class="token punctuation">.</span><span class="token function">NewTxBuilderFromCLI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">WithTxEncoder</span><span class="token punctuation">(</span>utils<span class="token punctuation">.</span><span class="token function">GetTxEncoder</span><span class="token punctuation">(</span>cdc<span class="token punctuation">)</span><span class="token punctuation">)</span>

			<span class="token keyword">if</span> err <span class="token operator">:=</span> cliCtx<span class="token punctuation">.</span><span class="token function">EnsureAccountExists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
				<span class="token keyword">return</span> err
			<span class="token punctuation">}</span>

			coins<span class="token punctuation">,</span> err <span class="token operator">:=</span> sdk<span class="token punctuation">.</span><span class="token function">ParseCoins</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
			<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
				<span class="token keyword">return</span> err
			<span class="token punctuation">}</span>

			msg <span class="token operator">:=</span> types<span class="token punctuation">.</span><span class="token function">NewMsgBuyName</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> coins<span class="token punctuation">,</span> cliCtx<span class="token punctuation">.</span><span class="token function">GetFromAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			err <span class="token operator">=</span> msg<span class="token punctuation">.</span><span class="token function">ValidateBasic</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
				<span class="token keyword">return</span> err
			<span class="token punctuation">}</span>

			cliCtx<span class="token punctuation">.</span>PrintResponse <span class="token operator">=</span> <span class="token boolean">true</span>

			<span class="token keyword">return</span> utils<span class="token punctuation">.</span><span class="token function">GenerateOrBroadcastMsgs</span><span class="token punctuation">(</span>cliCtx<span class="token punctuation">,</span> txBldr<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>sdk<span class="token punctuation">.</span>Msg<span class="token punctuation">{</span>msg<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// GetCmdSetName is the CLI command for sending a SetName transaction</span>
<span class="token keyword">func</span> <span class="token function">GetCmdSetName</span><span class="token punctuation">(</span>cdc <span class="token operator">*</span>codec<span class="token punctuation">.</span>Codec<span class="token punctuation">)</span> <span class="token operator">*</span>cobra<span class="token punctuation">.</span>Command <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>cobra<span class="token punctuation">.</span>Command<span class="token punctuation">{</span>
		Use<span class="token punctuation">:</span>   <span class="token string">&quot;set-name [name] [value]&quot;</span><span class="token punctuation">,</span>
		Short<span class="token punctuation">:</span> <span class="token string">&quot;set the value associated with a name that you own&quot;</span><span class="token punctuation">,</span>
		Args<span class="token punctuation">:</span>  cobra<span class="token punctuation">.</span><span class="token function">ExactArgs</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		RunE<span class="token punctuation">:</span> <span class="token keyword">func</span><span class="token punctuation">(</span>cmd <span class="token operator">*</span>cobra<span class="token punctuation">.</span>Command<span class="token punctuation">,</span> args <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
			cliCtx <span class="token operator">:=</span> context<span class="token punctuation">.</span><span class="token function">NewCLIContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">WithCodec</span><span class="token punctuation">(</span>cdc<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">WithAccountDecoder</span><span class="token punctuation">(</span>cdc<span class="token punctuation">)</span>

			txBldr <span class="token operator">:=</span> auth<span class="token punctuation">.</span><span class="token function">NewTxBuilderFromCLI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">WithTxEncoder</span><span class="token punctuation">(</span>utils<span class="token punctuation">.</span><span class="token function">GetTxEncoder</span><span class="token punctuation">(</span>cdc<span class="token punctuation">)</span><span class="token punctuation">)</span>

			<span class="token keyword">if</span> err <span class="token operator">:=</span> cliCtx<span class="token punctuation">.</span><span class="token function">EnsureAccountExists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
				<span class="token keyword">return</span> err
			<span class="token punctuation">}</span>

			msg <span class="token operator">:=</span> types<span class="token punctuation">.</span><span class="token function">NewMsgSetName</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> cliCtx<span class="token punctuation">.</span><span class="token function">GetFromAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			err <span class="token operator">:=</span> msg<span class="token punctuation">.</span><span class="token function">ValidateBasic</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
				<span class="token keyword">return</span> err
			<span class="token punctuation">}</span>

			cliCtx<span class="token punctuation">.</span>PrintResponse <span class="token operator">=</span> <span class="token boolean">true</span>

			<span class="token comment">// return utils.CompleteAndBroadcastTxCLI(txBldr, cliCtx, msgs)</span>
			<span class="token keyword">return</span> utils<span class="token punctuation">.</span><span class="token function">GenerateOrBroadcastMsgs</span><span class="token punctuation">(</span>cliCtx<span class="token punctuation">,</span> txBldr<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>sdk<span class="token punctuation">.</span>Msg<span class="token punctuation">{</span>msg<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Notes on the above code:</p> <ul><li>The <code>authcmd</code> package is used here. <a href="https://godoc.org/github.com/cosmos/cosmos-sdk/x/auth/client/cli#GetAccountDecoder" target="_blank" rel="noopener noreferrer">The godocs have more information on usage<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. It provides access to accounts controlled by the CLI and facilitates signing.</li></ul> <h3 id="now-your-ready-to-define-the-routes-that-the-rest-client-will-use-to-communicate-with-your-module"><a href="#now-your-ready-to-define-the-routes-that-the-rest-client-will-use-to-communicate-with-your-module" aria-hidden="true" class="header-anchor">#</a> Now your ready to define <a href="/tutorial/rest.html">the routes that the REST client will use to communicate with your module</a>!</h3></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.358745d0.js" defer></script><script src="/assets/js/13.8738af6e.js" defer></script>
  </body>
</html>
